# Head pain journal bot.
Бот для телеграма, который ведёт дневник головных болей.

### Опробовать можно тут: [@hp_journal_bot](https://t.me/hp_journal_bot).

### Что умеет:
- Напоминать о заполнении
- Проводить опрос о характере и типе боли. За основу взят опросник, который выдаётся в мед. учреждениях при постановке диагноза мигрени
- Присылать еженедельные отчёты в формате HTML
- Присылать отчёт по требованию за весь сохранённый период
- Хранить записи за последние 2 месяца

### На чём основан
- [Python Telegram Bot](https://github.com/python-telegram-bot/python-telegram-bot) для взаимодействия с АПИ телеги, а также дополнение к модулю job-queue для постановки задач на выполнение по времени. На этих задачах реализовано оповещение пользователей, еженедельные отчёты и очистка БД от устаревших данных.
- БД - SQLite3 наше всё для маленьких проектов. Если разрастётся, то переезд на PostgreSQL неминуем (как же не хватало возможностей hstore при работе с SQLite).
- Шаблонизатор [jinja2](https://github.com/pallets/jinja/) для построения отчётов в HTML формате.
- [aiosqlite](https://github.com/omnilib/aiosqlite) - асинхронные запросы к sqlite. В текущей реализации использует отдельный поток для запросов, сейчас этого хватает. Но хочется, чтобы приложение не тратило ресурсы на переключение между потоками. Возможно с python 3.12 будет иметь смысл спавнить отдельный интерпретатор в качестве менеджера БД и обмениваться данными через сокет, чтобы получить труЪ asyncio запросы к БД.

### Что ждёт в будущем
- Вывод предыдущего ответа на вопрос, если перезаписываешь день или возвращаешься к уже отвеченному вопросу.
- Вывод статистики за период, matplotlib умеет рисовать красивые графики.
- Добавить ещё форматов для генерации отчётов.
- Возможность слепить все еженедельные отчёты в один большой(?)
